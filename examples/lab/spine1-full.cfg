! Spine1 configuration - expanded with route policies
hostname spine1
!
username admin privilege 15 secret admin
!
management api gnmi
   transport grpc default
      port 6030
!
interface Ethernet1
   description Downlink to leaf1
   no switchport
   ip address 10.0.1.1/30
!
interface Ethernet2
   description Downlink to leaf2
   no switchport
   ip address 10.0.2.1/30
!
interface Loopback0
   description Router ID
   ip address 10.255.0.1/32
!
ip routing
!
! Prefix lists
ip prefix-list LOOPBACKS seq 10 permit 10.255.0.0/24 ge 32 le 32
ip prefix-list DEFAULT seq 10 permit 0.0.0.0/0
ip prefix-list CONNECTED seq 10 permit 10.0.0.0/8 le 30
!
! Route maps
route-map LEAF-IMPORT permit 10
   match ip address prefix-list LOOPBACKS
   set local-preference 150
!
route-map LEAF-IMPORT permit 20
   match ip address prefix-list CONNECTED
   set local-preference 100
!
route-map LEAF-EXPORT permit 10
   match ip address prefix-list LOOPBACKS
!
route-map LEAF-EXPORT permit 20
   match ip address prefix-list DEFAULT
!
router bgp 65000
   router-id 10.255.0.1
   !
   neighbor LEAFS peer group
   neighbor LEAFS send-community standard extended
   neighbor LEAFS maximum-routes 1000
   !
   neighbor 10.0.1.2 peer group LEAFS
   neighbor 10.0.1.2 remote-as 65001
   neighbor 10.0.1.2 description leaf1
   neighbor 10.0.1.2 route-map LEAF-IMPORT in
   neighbor 10.0.1.2 route-map LEAF-EXPORT out
   !
   neighbor 10.0.2.2 peer group LEAFS
   neighbor 10.0.2.2 remote-as 65002
   neighbor 10.0.2.2 description leaf2
   neighbor 10.0.2.2 route-map LEAF-IMPORT in
   neighbor 10.0.2.2 route-map LEAF-EXPORT out
   !
   network 10.255.0.1/32
!
! NTP
ntp server 10.0.0.250 prefer
ntp server 10.0.0.251
!
! DNS
ip name-server 10.0.0.250
ip domain-name lab.local
!
! Logging
logging host 10.0.0.252
!
